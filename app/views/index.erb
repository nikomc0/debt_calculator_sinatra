<!DOCTYPE html>
<html>
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-X78QM12ZF8"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'G-X78QM12ZF8');
		</script>
		<meta charset="UTF-8">
		<title>Debt Calculator</title>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="/style.css" type="text/css">
	</head>

	<body>
		<div class="container-fluid px-0">
			<div class="jumbotron text-white-50">
				<div class="row justify-content-end">
				<div id="show_info" class="col-5">
					<div id="personal__info" class="d-none">
						<%= erb(:personal_info) %>
					</div>
				</div>
					<div class="col-1">
						<span id="info__button" style="font-size: 1.5rem;"><i class="fas fa-user-cog"></i></span></ion-icon>
					</div>
				</div>

			  <h1 class="display-4">Debt Calculator</h1>
			  <hr class="my-4">
			  <div class="row text-center">
				  <div class="col-md"><p class="lead">
				  	<div id="total_accounts" class="main-dashboard rounded active">
					  	<span style="font-size: 3rem;"><i class="far fa-credit-card"></i></span><br>
					  	<h4><strong>Accounts</strong></h4></p>
							<div class="col-md"><h5><%= $total_accounts %></h5></div>
						</div>
				  </div>
					<div class="col-md"><p class="lead">
						<div id="total_debt" class="main-dashboard rounded">
							<span style="font-size: 3rem;"><i class="fas fa-dollar-sign"></i></span><br>
							<h4><strong>Total Debt</strong></h4></p>
							<div class="col-md"><h5>$<%= '%.2f' % $total_debt %></h5></div>
						</div>
					</div>
				  <div class="col-md"><p class="lead">
				  	<div id="monthly_budget" class="main-dashboard rounded">
					  	<span style="font-size: 3rem;"><i class="fas fa-piggy-bank"></i></span><br>
					  	<h4><strong>Monthly Budget</strong></h4></p>
					  	<div id="monthly__payment" class="col-md"><h5>$<%= '%.2f' % $monthly_payment %></h5></div>
					  </div>
				  </div>
				</div>
			</div>
	   </div>

			<div class="container-fluid">
				<div id="accounts-section" class="row">
					<div id="account_list" class="shadow p-3 mb-5 bg-white rounded col mx-2">
						<div class="row mt-2 mb-0">
							<div class="col">
								<h5 class="mb-0">Accounts</h5>
							</div>
							<!-- Button trigger modal -->
							<div>
								<h6 id="account" class="m-0 px-4" style="font-size: .75rem;" data-toggle="modal" data-target="#newAccount">Add Account</h6>
							</div>
						</div>

						<hr>
						<% if $accounts %>
							<%= erb(:accounts) %>
						<% end %>

						<!-- Modal -->
						<%= erb(:'accounts/_new') %>

						<%= erb(:'accounts/_edit') %>
					</div>
					

					<div id="table_section" class="col-9 table-responsive mx-2 shadow p-3 mb-5 bg-white rounded">
						<table class="table table-hover table-striped table-sm">
							<% if @current_account %>
								<%= erb(:'accounts/_edit') %>
								<%= erb(:account) %>
							<% end %>	
						</table>
					</div>

					<!-- 
						<div class="show-more">
								<ion-icon name="arrow-dropdown"></ion-icon>
						</div> 
					-->
				</div>
			</div>
		<script src="/scripts.js"></script>
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
		<script src="https://unpkg.com/ionicons@4.5.0/dist/ionicons.js"></script>

		<script>
			var elements = document.querySelectorAll('.table__payment');
			var monthlyPayment = document.querySelector('.monthly__payment');

			var setListener = function(el){
				var events = ['click', 'keypress'];

				// iterates over event types
				events.forEach(event => {
					el.addEventListener(event, function(event){
						if (event.which === 1) {
							el.contentEditable = 'true';
						} else if (event.which === 13) {
							el.contentEditable = 'false';
						}
					});
				});
			};

			// Iterates over and sets event listeners on table payments
			elements.forEach(el => {
				setListener(el);
			});

			const getValue = () => {
				console.log($balance);
			};

		</script>
	</body>
</html>
